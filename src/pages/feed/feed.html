<ion-header>
    <ion-navbar>
        <ion-title>
            <img class="rally-header-logo" src="assets/img/rally-logo.svg">
        </ion-title>
        <ion-buttons start style="order:1;">
            <button ion-button icon-only (click)="goToRequests()">
       <img src="assets/img/add.svg" alt="" style="height: 20px; width:20px;">
      </button>
        </ion-buttons>
        <ion-buttons end>
            <button ion-button icon-only (click)="goToEventFilter()">
                <img src="assets/img/Filter.svg" alt="" style="height: 20px; width:20px;">
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header><ion-content>
    <ion-row class="data-row" *ngIf="enabled">
        <ion-item>
            You're in data saving mode
            <ion-icon name="ios-close" item-end></ion-icon>
        </ion-item>

    </ion-row>
    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content pullingText="Pull down to Refresh" pullingIcon="arrow-dropdown" refreshingSpinner="circles" refreshingText="Refreshing...">
        </ion-refresher-content>
    </ion-refresher>
    <ion-card style="position: relative;" *ngFor="let objective of objectives,let i = index" class="objectives-card">

        <ion-fab right top>
            <button ion-fab color="light"><ion-icon name="ios-more"></ion-icon></button>
            <ion-fab-list side="left">

                <button ion-fab (click)="hideItem(objective.id, i)"><ion-icon name="md-done-all"></ion-icon></button>
            </ion-fab-list>
        </ion-fab>

        <ion-item>
            <ion-avatar item-start>
                <img [src]="objective.organization['image_url'] ? objective.organization['image_url'] : testPhoto" (click)="goToOrganizationProfile(objective.organization_id)">
            </ion-avatar>
            <button (click)="goToOrganizationProfile(objective.organization_id)" style="background: none; padding-left:0;">
        <h2> <small>via</small> {{objective.organization['name']}}</h2>
    </button>
            <p><small>{{objective.created_at | amTimeAgo}}</small></p>
        </ion-item>
        <div (click)="goToActionPage(objective.id, objective?.goals[0]?.goal_type)" class="organization-bg" [ngStyle]="{ 'background-image' : 'url(' + objective.image_url +')'}">
                
        <!-- <div (click)="goToActionPage(objective.id)" class="organization-bg" [ngStyle]="{ 'background-image' : 'url(' + objective.image_url !== null ? objective.image_url : localPhoto +')'}"> -->
            <!-- <div class="days-excerpt">
                <p class="white">{{objective?.goals[0]?.description}}</p>
            </div> -->
            <div class="railled-excerpt">
                <p class="white"><strong>{{objective.rallies}}</strong><br> Rallied</p>
            </div>
           <div class="bottom-excerpt">
                <p class="white">{{objective?.title}}</p>
            </div>
            <div class="btn-objectives-contact">
                <button ion-button *ngIf="objective?.goals[0]?.goal_type !== 'sign'">Contact</button>
                <button ion-button *ngIf="objective?.goals[0]?.goal_type === 'sign'">Sign</button>

                
                
                
            </div>
        </div>


        <ion-card-content>
            <p>{{objective.description | truncate : 200 : '...'}}</p>
           
        </ion-card-content>
        <ion-row>
          

        </ion-row>

        <ion-row>
            <button [disabled]="disable" class="btn-50 right-border" ion-button icon-left clear full (click)="getLikeStatus($event, objective?.goals[0]?.id, goalLike)" [ngStyle]="{'background-color': findInLoop(objective?.goals[0]?.user_likes)}">
                <ion-icon name="ios-heart" ></ion-icon>
                {{objective.likes}}
            </button>
            <button [disabled]="disable" class="btn-50" ion-button icon-left clear full (click)="shareController(objective.title, localPhoto, objective?.goals[0]?.id, shareAction, $event)">
                    <ion-icon name="ios-share-alt"></ion-icon>
                    {{objective.shares}}
                </button>

        </ion-row>

    </ion-card>



    <ion-card class="events-card" *ngFor="let event of events">

        <ion-fab right top>
            <button ion-fab color="light"><ion-icon name="ios-more"></ion-icon></button>
            <ion-fab-list side="left">

                <button ion-fab><ion-icon name="md-done-all"></ion-icon></button>
            </ion-fab-list>
        </ion-fab>

        <ion-item>
            <ion-avatar item-start>
                <img [src]="event.organization[0].image_url ? event.organization[0].image_url : testPhoto" (click)="goToOrganizationProfile(event.organization_id)">
            </ion-avatar>
            <button (click)="goToOrganizationProfile(event.organization_id)" style="background: none; padding-left:0;">
                <h2 text-wrap style="text-align: left; max-width: 85%;"> <small>via</small> {{event.organization[0].name}}</h2>
            </button>
            <p><small>Event Location: {{event.locations}}</small></p>
        </ion-item>
        <div class="events-bg" (click)="goToEventDetail(event.id)" [ngStyle]="{'background-image': 'url(' + event.image_url + ')'}">
            <div class="events-filter"></div>
            <div class="events-railled">
                <p class="white"><strong>{{event.attending}}</strong><br> Attending</p>

            </div>
            <div class="date-events-spans">
                <span class="day">Saturday</span>
                <span class="month">NOV 29</span>
            </div>
        </div>
        <ion-card-content>
            <ion-card-title>{{event.title}}</ion-card-title>
            <!-- <p class="event-description">{{event.description}}</p> -->
        </ion-card-content>

        <ion-row>
            <button [disabled]="disable" class="btn-50 right-border" ion-button icon-left clear full (click)="getLikeStatus($event, event.id, eventLike)" [ngStyle]="{'background-color': findInLoop(event?.user_likes)}">
                <ion-icon name="ios-heart" ></ion-icon>
                {{event.likes}}
            </button>
            <button [disabled]="disable" class="btn-50" ion-button icon-left clear full (click)="shareController(event.title, testPhoto, event.id, shareAction, $event)">
                    <ion-icon name="ios-share-alt"></ion-icon>
                    {{event.shares}}
                </button>

        </ion-row>

    </ion-card>

    <ion-card *ngFor="let activity of fiends" style="position: relative;" class="friends-card">
          <ion-fab right top style="top: 4px;
    right: 0;">
            <button ion-fab color="light"><ion-icon name="ios-more"></ion-icon></button>
            <ion-fab-list side="left">
                <button ion-fab><ion-icon name="logo-facebook"></ion-icon></button>
                <button ion-fab><ion-icon name="logo-twitter"></ion-icon></button>
                <button ion-fab><ion-icon name="logo-vimeo"></ion-icon></button>
                <button ion-fab><ion-icon name="logo-googleplus"></ion-icon></button>
            </ion-fab-list>
        </ion-fab>

           
                    <ion-item>
                        <ion-avatar item-start>
                          <img [src]="activity.user_id[0]['photo_url'] ? activity.user_id[0]['photo_url'] : avatarPhotp">
                        </ion-avatar>
                        <h2 (click)="goToPublicProfile(activity.user_id[0]['id'])">{{activity.user_id[0]['name']}}</h2>
                        <div style="display: flex;">
                            <p><small>{{activity.created_at | amTimeAgo}}</small>  </p>
                           
                        </div>
                        

                      </ion-item>
                <ion-card-content>
                   
                     <p>{{activity.description}}</p>
                </ion-card-content>
       

        <ion-fab right bottom style="bottom: 50px;
    right: 0;">
            <div class="blue-icon" ion-fab color="light">
                <img *ngIf="activity.title === 'call'" src="assets/img/Contact-orange.svg" alt="" style="width: 25px;">
                <img *ngIf="activity.title === 'money'" src="assets/img/Donate.svg" alt="" style="width: 25px;">
                <img *ngIf="activity.title === 'write'" src="assets/img/Sign.svg" alt="" style="width: 25px;">
            </div>
        </ion-fab>

        <ion-row>
            <ion-col class="blue-card">
                <button ion-button icon-left clear full>
        <ion-icon name="md-heart" ios="md-heart" md="ios-heart"></ion-icon>
        371
      </button>
            </ion-col>
            <ion-col class="blue-card" style="border-right: none;">
                <button ion-button icon-left clear full>
        <ion-icon name="ios-share-alt"></ion-icon>
        12
      </button>
            </ion-col>

        </ion-row>

    </ion-card>

</ion-content>
