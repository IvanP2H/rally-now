<ion-header>
        <ion-navbar>
            <ion-title>
                <p class="white">Organizations</p>
            </ion-title>
            <ion-buttons end>
                <button ion-button icon-only (click)="goToEventFilter()" *ngIf="!eventFiltered">
                    <img src="assets/img/Filter.svg" alt="" style="height: 20px; width:20px;">
                </button>
                <button ion-button icon-only (click)="goToEventFilter()" *ngIf="eventFiltered">
                        <img src="assets/img/filter-selected.svg" alt="" style="height: 20px; width:20px;">
                    </button>
            </ion-buttons>
        </ion-navbar>
    </ion-header>
<ion-content>
        <ion-spinner *ngIf="loader"></ion-spinner>

        <ion-refresher (ionRefresh)="doRefresh($event)">
                <ion-refresher-content pullingText="Pull down to Refresh" pullingIcon="arrow-dropdown" refreshingSpinner="circles" refreshingText="Refreshing...">
                </ion-refresher-content>
            </ion-refresher>
            <div class="timeline-wrapper" *ngIf="enablePlaceholder">
                <div class="timeline-item">
                    <div class="animated-background">
                        <div class="background-masker header-top"></div>
                        <div class="background-masker header-left"></div>
                        <div class="background-masker header-right"></div>
                        <div class="background-masker header-bottom"></div>
                        <div class="background-masker subheader-left"></div>
                        <div class="background-masker subheader-right"></div>
                        <div class="background-masker subheader-bottom"></div>
                        <div class="background-masker content-top"></div>
                        <div class="background-masker content-first-end"></div>
                        <div class="background-masker content-second-line"></div>
                        <div class="background-masker content-second-end"></div>
                        <div class="background-masker content-third-line"></div>
                        <div class="background-masker content-third-end"></div>
                    </div>
                </div>
            </div>
        
            <div class="timeline-wrapper" *ngIf="enablePlaceholder">
                <div class="timeline-item">
                    <div class="animated-background">
                        <div class="background-masker header-top"></div>
                        <div class="background-masker header-left"></div>
                        <div class="background-masker header-right"></div>
                        <div class="background-masker header-bottom"></div>
                        <div class="background-masker subheader-left"></div>
                        <div class="background-masker subheader-right"></div>
                        <div class="background-masker subheader-bottom"></div>
                        <div class="background-masker content-top"></div>
                        <div class="background-masker content-first-end"></div>
                        <div class="background-masker content-second-line"></div>
                        <div class="background-masker content-second-end"></div>
                        <div class="background-masker content-third-line"></div>
                        <div class="background-masker content-third-end"></div>
                    </div>
                </div>
            </div>
        
            <div class="timeline-wrapper" *ngIf="enablePlaceholder">
                <div class="timeline-item">
                    <div class="animated-background">
                        <div class="background-masker header-top"></div>
                        <div class="background-masker header-left"></div>
                        <div class="background-masker header-right"></div>
                        <div class="background-masker header-bottom"></div>
                        <div class="background-masker subheader-left"></div>
                        <div class="background-masker subheader-right"></div>
                        <div class="background-masker subheader-bottom"></div>
                        <div class="background-masker content-top"></div>
                        <div class="background-masker content-first-end"></div>
                        <div class="background-masker content-second-line"></div>
                        <div class="background-masker content-second-end"></div>
                        <div class="background-masker content-third-line"></div>
                        <div class="background-masker content-third-end"></div>
                    </div>
                </div>
            </div>

        <div *ngFor="let record of records, let i = index">
            <!-- Tweet Cards -->
            <ion-card class="reps-card" style="position: relative;" *ngIf="record.card_type === 'tweet'">
                <ion-fab right top>
                    <button ion-fab color="light">
                        <ion-icon name="ios-more"></ion-icon>
                    </button>
                  
                </ion-fab>
                <ion-card-header>
                    <ion-item>
                        <ion-avatar item-start>
                          <img [src]="record.photo_url ? record.photo_url : record.image_url ">
                        </ion-avatar>
                        <!-- only show icon on verified accounts <h2 style="display: flex;">Senator Bob Jones <img *ngIf="{{rep.verified === true}}" style="width: 12px; height: 12px; margin-left: 5px;" src="assets/img/TwtterVerified.svg" alt=""></h2> -->
        
                        <h2 style="display: flex; font-weight:bold;">{{record.name}}</h2>
                        <p><small>@{{record.username}} â€¢ {{record.tweet_created_at | amTimeAgo}}</small></p>
                      </ion-item>
                </ion-card-header>
                <ion-card-content (click)="openWebpage(record.twitter_username, record.tweet_id)">
                    <ion-row>
                        <ion-col col-10>
                            <blockquote style="margin: 0 !important;" class="twitter-video" data-lang="es"> 
                                {{record.tweet}}
                            </blockquote>               
                        </ion-col>
                        <ion-col col-2 text-right style="line-height: 50px;">
        
                            <ion-icon name="logo-twitter"></ion-icon>
                        </ion-col>
                        
                    </ion-row>
                </ion-card-content>
               
                <ion-row>
                    <button [disabled]="disable" class="btn-50 right-border" ion-button icon-left clear full (click)="getLikeStatus($event, record.id, tweetLike)" [ngStyle]="{'background-color': findInLoop(record.likes), 'color': getColor(record.likes)}">
                        <ion-icon name="{{getIcon(record.likes)}}" ></ion-icon>
                        {{record.likes_count}}
                    </button>
                    <button [disabled]="disable" class="btn-50" ion-button icon-left clear full (click)="shareController(record.tweet, record.photo_url, record.id, shareAction, $event)">
                        <img src="assets/img/Share-white.svg" style="width: 17px; margin-right:8px;">
                        {{record.shares_count}}                           
                    </button>
        
                </ion-row>
            </ion-card>
    
            <!-- End Twitter Card -->
    
            <!-- Objectives Card -->
    
            <ion-card style="position: relative;" *ngIf="record.card_type === 'objective'" class="objectives-card">
    
                    <ion-fab right top>
                        <button (click)="ellipsisController(record.organization['name'], record.id, i, record.organization_id, record.description, record.organization['followers'], record.organization['notify'] )" ion-fab color="light"><ion-icon name="ios-more"></ion-icon></button>
                        <!-- <ion-fab-list side="left">
            
                            <button ion-fab (click)="hideItem(objective.id, i)"><ion-icon name="md-done-all"></ion-icon></button>
                        </ion-fab-list> -->
                    </ion-fab>
            
                    <ion-item>
                        <ion-avatar item-start>
                            <img [src]="record.organization['image_url'] ? record.organization['image_url'] : 'assets/img/org_icon.svg'" (click)="goToOrganizationProfile(record.organization_id)">
                        </ion-avatar>
                        <button (click)="goToOrganizationProfile(record.organization_id)" style="background: none; padding-left:0;">
                    <h2> <small>via</small> {{record.organization['name']}}</h2>
                </button>
                        <p><small>{{record.created_at | amTimeAgo}}</small></p>
                    </ion-item>
                    <div (click)="goToActionPage(record.id, record?.goals[0]?.goal_type, record?.goals[0]?.source_link, record?.goals[0]?.id, record?.goals[0]?.reps_goals[0]?.id)" class="organization-bg" [ngStyle]="{ 'background-image' : 'url(&#34;' + record.image_url +'&#34;)'}">
                            
                    <!-- <div (click)="goToActionPage(objective.id)" class="organization-bg" [ngStyle]="{ 'background-image' : 'url(' + objective.image_url !== null ? objective.image_url : localPhoto +')'}"> -->
                        <!-- <div class="days-excerpt">
                            <p class="white">{{objective?.goals[0]?.description}}</p>
                        </div> -->
                        <div class="railled-excerpt" *ngIf="record.rallies > 0">
                            <p class="white"><strong>{{record.rallies}}</strong><br> Rallied</p>
                        </div>
                       <div class="bottom-excerpt">
                            <p class="white">{{record?.title}}</p>
                        </div>
                        <div class="btn-objectives-contact">
                            <button ion-button *ngIf="record?.goals[0]?.goal_type !== 'sign'">Contact</button>
                            <button ion-button *ngIf="record?.goals[0]?.goal_type === 'sign'">Sign</button>
            
                            
                            
                            
                        </div>
                    </div>
            
            
                    <ion-card-content>
                        <p>{{record.description | truncate : 200 : '...'}}</p>
                       
                    </ion-card-content>
                    <ion-row>
                      
            
                    </ion-row>
            
                    <ion-row>
                        <button [disabled]="disable" class="btn-50 right-border" ion-button icon-left clear full (click)="getLikeStatus($event, record?.goals[0]?.id, goalLike)" [ngStyle]="{'background-color': findInLoop(record?.goals[0]?.user_likes), 'color': getColor(record?.goals[0]?.user_likes)}">
                            <ion-icon name="{{getIcon(record?.goals[0]?.user_likes)}}" ></ion-icon>
                            {{record.likes}}
                        </button>
                        <button [disabled]="disable" class="btn-50" ion-button icon-left clear full (click)="shareController(record.title, record.image_url, record?.goals[0]?.id, shareAction, $event)">
                                <!-- <ion-icon name="ios-share-alt"></ion-icon> -->
                                <img src="assets/img/Share-white.svg" style="width: 17px; margin-right:8px;">
                                {{record.shares}}
                            </button>
            
                    </ion-row>
            
                </ion-card>
            
                <!-- End Objectives Card -->
    
                <!-- Events Card -->
    
                <ion-card class="events-card" *ngIf="record.card_type === 'events'">
    
                        <ion-fab right top>
                            <button ion-fab color="light" (click)="eventEllipsisController(record.organization[0].name, record.organization_id, record.title, record.organization[0].followers, record.organization[0].notify)" ><ion-icon name="ios-more"></ion-icon></button>
                             <!-- <ion-fab-list side="left">
                
                                <button ion-fab><ion-icon name="md-done-all"></ion-icon></button>
                            </ion-fab-list> -->
                        </ion-fab>
                
                        <ion-item>
                            <ion-avatar item-start>
                                <img [src]="record.organization[0].image_url ? record.organization[0].image_url  : 'assets/img/org_icon.svg'" (click)="goToOrganizationProfile(record.organization_id)">
                            </ion-avatar>
                            <button (click)="goToOrganizationProfile(record.organization_id)" style="background: none; padding-left:0; max-width: 85%;">
                                <h2 text-wrap style="text-align: left; "> <small>via</small> {{record.organization[0].name}}</h2>
                            </button>
                            <p><small>Event Location: {{record.city}}</small></p>
                        </ion-item>
                        <div class="events-bg" (click)="goToEventDetail(record.id)" [ngStyle]="{'background-image': 'url(' + record.image_url + ')'}">
                            <div class="events-filter"></div>
                            <div class="events-railled" *ngIf="record.attending > 0">
                                <p class="white"><strong>{{record.attending}}</strong><br> Attending</p>
                
                            </div>
                            <div class="date-events-spans" *ngIf="record.start_date != null">
                                <span class="day">{{getDay(record.start_date)}}</span>
                                <span class="month">{{getShortDate(record.start_date)}}</span>
                            </div>
                        </div>
                        <ion-card-content (click)="goToEventDetail(record.id)">
                            <ion-card-title>{{record.title}}</ion-card-title>
                            <!-- <p class="event-description">{{event.description}}</p> -->
                       </ion-card-content>
                
                        <ion-row>
                            <button [disabled]="disable" class="btn-50 right-border" ion-button icon-left clear full (click)="getLikeStatus($event, record.id, eventLike)" [ngStyle]="{'background-color': findInLoop(record?.user_likes), 'color': getColor(record?.user_likes)}">
                                <ion-icon name="{{getIcon(record?.user_likes)}}" ></ion-icon>
                                {{record.likes}}
                            </button>
                            <button [disabled]="disable" class="btn-50" ion-button icon-left clear full (click)="shareController(record.title, record.image_url, record.id, shareAction, $event)">
                                    <!-- <ion-icon name="ios-share-alt"></ion-icon> -->
                                    <img src="assets/img/Share-white.svg" style="width: 17px; margin-right:8px;">
                                    {{record.shares}}
                                </button>
                
                        </ion-row>
                
                    </ion-card>
    
                    <!-- End Events Card -->

                  
    
        </div>

        <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
            <ion-infinite-scroll-content
            loadingSpinner="bubbles"
            loadingText="Loading more..."></ion-infinite-scroll-content>
          </ion-infinite-scroll>
    
        
    
        
</ion-content>